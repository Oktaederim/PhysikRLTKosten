<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zuluftanlagen-Kostenrechner (Mehrkosten)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom Font */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
            color: #1f2937;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <script>
        // Globale physikalische Konstanten
        const RHO_LUFT = 1.2; // Dichte der Luft in kg/m¬≥
        const CP_LUFT = 1005; // Spezifische W√§rmekapazit√§t der Luft in J/kgK
        const V_NENN_ANCHOR = 16.7; // Volumenstrom bei Nenndrehzahl (m¬≥/s) - Annahme aus vorherigem Kontext
        const N_NENN_ANCHOR = 1050; // Nenndrehzahl des Ventilators (min‚Åª¬π) - Annahme aus vorherigem Kontext

        // Funktion zur Berechnung der Mehrkosten
        function calculateCosts() {
            // 1. Eingabewerte auslesen
            const dp1 = parseFloat(document.getElementById('dp1').value);
            const pel1 = parseFloat(document.getElementById('pel1').value);
            const n1 = parseFloat(document.getElementById('n1').value);

            const dp2 = parseFloat(document.getElementById('dp2').value);

            const tJahr = parseFloat(document.getElementById('tJahr').value);
            const pKwhEl = parseFloat(document.getElementById('pKwhEl').value);
            const pKwhTherm = parseFloat(document.getElementById('pKwhTherm').value);
            const tHeizJahr = parseFloat(document.getElementById('tHeizJahr').value);
            const deltaT = parseFloat(document.getElementById('deltaT').value);
            const etaHeizung = parseFloat(document.getElementById('etaHeizung').value);

            const resultsDiv = document.getElementById('results');
            const errorDiv = document.getElementById('error');
            errorDiv.classList.add('hidden');

            // Grundlegende Validierung
            if (isNaN(dp1) || isNaN(pel1) || isNaN(n1) || isNaN(dp2) || isNaN(tJahr) || isNaN(pKwhEl) || isNaN(pKwhTherm) || isNaN(tHeizJahr) || isNaN(deltaT) || isNaN(etaHeizung) || dp1 <= 0 || dp2 <= 0 || n1 <= 0) {
                errorDiv.textContent = "Fehler: Bitte alle Felder korrekt ausf√ºllen. Dr√ºcke und Drehzahlen m√ºssen positiv sein.";
                errorDiv.classList.remove('hidden');
                resultsDiv.classList.add('hidden');
                return;
            }

            // --- 2. Berechnung der Betriebspunkte mittels √Ñhnlichkeitsgesetzen ---

            // 2.1 Drehzahlverh√§ltnis (k) basierend auf dem Druck (Quadratisches Gesetz: dp2/dp1 = k¬≤)
            const k = Math.sqrt(dp2 / dp1);
            const n2 = n1 * k;
            
            // 2.2 Neue Elektrische Leistung (Kubisches Gesetz: Pel2/Pel1 = k¬≥)
            const pel2 = pel1 * Math.pow(k, 3);
            const deltaPel = pel2 - pel1;

            // 2.3 Volumenstrom (Lineares Gesetz: V ~ n)
            // Sch√§tzung des Volumenstroms V1 basierend auf den Nenn-Ankerwerten (V_NENN_ANCHOR bei N_NENN_ANCHOR)
            const v1 = V_NENN_ANCHOR * (n1 / N_NENN_ANCHOR); // V1 in m¬≥/s
            const v2 = v1 * k; // V2 in m¬≥/s
            const deltaV = v2 - v1; // Mehrvolumenstrom in m¬≥/s

            // --- 3. Berechnung der Mehrkosten ---

            // 3.1 Elektrische Mehrkosten (Ventilator)
            const mehrkostenEl = deltaPel * tJahr * pKwhEl;

            // 3.2 Thermische Mehrkosten (Heizung)
            
            // Zus√§tzliche thermische Leistung (P_therm = deltaV * rho * cp * deltaT)
            // P_therm in J/s (W)
            const pThermDeltaW = deltaV * RHO_LUFT * CP_LUFT * deltaT;
            
            // P_therm in kW
            const pThermDeltaKW = pThermDeltaW / 1000;

            // Ben√∂tigte Energie (kWh) inkl. Wirkungsgrad
            const eThermKwh = (pThermDeltaKW * tHeizJahr) / etaHeizung;

            // Thermische Mehrkosten
            const mehrkostenTherm = eThermKwh * pKwhTherm;

            // 3.3 Gesamt-Mehrkosten
            const mehrkostenGesamt = mehrkostenEl + mehrkostenTherm;
            
            // --- 4. Ausgabe der Ergebnisse ---
            
            resultsDiv.classList.remove('hidden');
            document.getElementById('dpTheorie').textContent = `${dp2.toFixed(0)} Pa`;
            document.getElementById('n2Theorie').textContent = `${n2.toFixed(0)} min‚Åª¬π`;
            document.getElementById('v1Berechnet').textContent = `${(v1 * 3600).toFixed(0)} m¬≥/h (${v1.toFixed(2)} m¬≥/s)`;
            document.getElementById('v2Berechnet').textContent = `${(v2 * 3600).toFixed(0)} m¬≥/h (${v2.toFixed(2)} m¬≥/s)`;
            document.getElementById('pel2Theorie').textContent = `${pel2.toFixed(2)} kW`;
            document.getElementById('deltaVValue').textContent = `${(deltaV * 3600).toFixed(0)} m¬≥/h`;
            document.getElementById('deltaPelValue').textContent = `${deltaPel.toFixed(2)} kW`;
            document.getElementById('pThermDeltaKW').textContent = `${pThermDeltaKW.toFixed(1)} kW`;
            
            document.getElementById('mehrkostenEl').textContent = `${mehrkostenEl.toFixed(2)} ‚Ç¨/a`;
            document.getElementById('mehrkostenTherm').textContent = `${mehrkostenTherm.toFixed(2)} ‚Ç¨/a`;
            document.getElementById('mehrkostenGesamt').textContent = `${mehrkostenGesamt.toFixed(2)} ‚Ç¨/a`;
        }

        // F√ºhrt die Berechnung beim Laden der Seite und bei √Ñnderungen aus
        window.onload = function() {
            calculateCosts();
            document.querySelectorAll('input').forEach(input => {
                input.addEventListener('input', calculateCosts);
            });
        };
    </script>

    <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-xl p-6 md:p-10">
        <h1 class="text-3xl font-bold mb-2 text-indigo-700">Zuluft-Kostenrechner (Druck√§nderung)</h1>
        <p class="text-gray-600 mb-8">Berechnung der zus√§tzlichen j√§hrlichen Betriebs- und Heizkosten, wenn der Kanaldruck erh√∂ht wird (keine WRG).</p>

        <!-- Container for Inputs -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Sektion 1: Betriebspunkt 1 (Aktuelle Referenz) -->
            <div class="p-5 bg-gray-50 border-t-4 border-indigo-500 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4 text-indigo-600">1. Betriebspunkt (Ist-Zustand)</h2>
                <div class="space-y-4">
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">Druck Œîp‚ÇÅ (Ist) [Pa]</span>
                        <input type="number" id="dp1" value="130" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-indigo-500">
                    </label>
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">Elektrische Leistung P‚Çë‚Çó,‚ÇÅ [kW]</span>
                        <input type="number" id="pel1" value="5" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-indigo-500">
                    </label>
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">Drehzahl n‚ÇÅ [min‚Åª¬π]</span>
                        <input type="number" id="n1" value="1350" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-indigo-500">
                    </label>
                    <div class="text-xs text-gray-500 pt-2">
                        *Annahme f√ºr Volumenstrom-Kalkulation: VÃá‚Çô‚Çë‚Çô‚Çô = 16,7 m¬≥/s bei n‚Çô‚Çë‚Çô‚Çô = 1050 min‚Åª¬π.
                    </div>
                </div>
            </div>

            <!-- Sektion 2: Ziel-Betriebspunkt und Betriebsparameter -->
            <div class="p-5 bg-gray-50 border-t-4 border-teal-500 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4 text-teal-600">2. Ziel & Parameter</h2>
                <div class="space-y-4">
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">Ziel-Druck Œîp‚ÇÇ (Soll) [Pa]</span>
                        <input type="number" id="dp2" value="260" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-teal-500 font-bold bg-yellow-100">
                    </label>
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">J√§hrliche Laufzeit t [h/a]</span>
                        <input type="number" id="tJahr" value="8670" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-teal-500">
                    </label>
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">J√§hrliche Heizstunden t‚Çï‚Çë·µ¢ùóì [h/a]</span>
                        <input type="number" id="tHeizJahr" value="2000" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-teal-500">
                    </label>
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">Temperaturdifferenz ŒîT [K] (Zuluft - Au√üen)</span>
                        <input type="number" id="deltaT" value="20" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-teal-500">
                    </label>
                </div>
            </div>

            <!-- Sektion 3: Kostenparameter und Wirkungsgrade -->
            <div class="p-5 bg-gray-50 border-t-4 border-red-500 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4 text-red-600">3. Kosten & Effizienz</h2>
                <div class="space-y-4">
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">Strompreis P‚Çñùìå‚Çï,‚Çë‚Çó [‚Ç¨/kWh]</span>
                        <input type="number" id="pKwhEl" value="0.25" step="0.01" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-red-500">
                    </label>
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">Heizenergiepreis P‚Çñùìå‚Çï,‚Çú‚Çï‚Çë·µ£‚Çò [‚Ç¨/kWh]</span>
                        <input type="number" id="pKwhTherm" value="0.10" step="0.01" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-red-500">
                    </label>
                    <label class="block">
                        <span class="text-sm font-medium text-gray-700">Heizungs-Wirkungsgrad Œ∑‚Çï‚Çë·µ¢ùóì [-]</span>
                        <input type="number" id="etaHeizung" value="0.90" step="0.01" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:border-red-500">
                    </label>
                    <div class="text-xs text-gray-500 pt-2">
                        *Luftdichte œÅ = 1,2 kg/m¬≥; c‚Çö = 1005 J/kgK.
                    </div>
                </div>
            </div>
        </div>

        <div id="error" class="hidden mt-8 p-4 bg-red-100 text-red-700 font-semibold rounded-lg"></div>

        <!-- Section for Calculated Results -->
        <div id="results" class="mt-10 pt-6 border-t-2 border-gray-200">
            <h2 class="text-2xl font-bold mb-6 text-gray-800">Ergebnisse und Mehrkosten</h2>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <!-- Neue Betriebsdaten (Theorie) -->
                <div class="p-6 bg-blue-50 rounded-lg border border-blue-200">
                    <h3 class="text-xl font-semibold mb-4 text-blue-700">Neuer Betriebspunkt (Theorie)</h3>
                    <div class="space-y-3">
                        <p class="flex justify-between border-b pb-1 text-sm"><span class="font-medium">Ziel-Druck Œîp‚ÇÇ:</span> <span id="dpTheorie" class="font-bold text-blue-800"></span></p>
                        <p class="flex justify-between border-b pb-1 text-sm"><span class="font-medium">Erforderliche Drehzahl n‚ÇÇ:</span> <span id="n2Theorie" class="font-bold text-blue-800"></span></p>
                        <p class="flex justify-between border-b pb-1 text-sm"><span class="font-medium">Volumenstrom VÃá‚ÇÅ (Ist):</span> <span id="v1Berechnet" class="font-bold text-gray-600"></span></p>
                        <p class="flex justify-between border-b pb-1 text-sm"><span class="font-medium">Volumenstrom VÃá‚ÇÇ (Soll):</span> <span id="v2Berechnet" class="font-bold text-blue-800"></span></p>
                        <p class="flex justify-between text-sm"><span class="font-medium">Ben√∂tigte Leistung P‚Çë‚Çó,‚ÇÇ:</span> <span id="pel2Theorie" class="font-bold text-blue-800"></span></p>
                    </div>
                </div>

                <!-- Wichtige Differenzen -->
                <div class="p-6 bg-yellow-50 rounded-lg border border-yellow-200">
                    <h3 class="text-xl font-semibold mb-4 text-yellow-700">Wichtige Differenzen</h3>
                    <div class="space-y-3">
                        <p class="flex justify-between border-b pb-1 text-sm"><span class="font-medium">Mehrvolumenstrom ŒîVÃá:</span> <span id="deltaVValue" class="font-bold text-yellow-800"></span></p>
                        <p class="flex justify-between border-b pb-1 text-sm"><span class="font-medium">Mehrleistung Ventilator ŒîP‚Çë‚Çó:</span> <span id="deltaPelValue" class="font-bold text-yellow-800"></span></p>
                        <p class="flex justify-between text-sm"><span class="font-medium">Zus√§tzliche thermische Leistung ŒîP‚Çú‚Çï‚Çë·µ£‚Çò:</span> <span id="pThermDeltaKW" class="font-bold text-yellow-800"></span></p>
                    </div>
                </div>
            </div>

            <!-- Endresultat (Kosten) -->
            <div class="p-8 bg-red-50 rounded-lg border-2 border-red-300">
                <h3 class="text-2xl font-bold mb-4 text-red-700">Gesamte J√§hrliche Mehrkosten (Ohne WRG)</h3>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <div class="border-l-4 border-red-500 pl-4">
                        <p class="text-lg font-medium text-gray-600">Elektrisch (Ventilator)</p>
                        <p id="mehrkostenEl" class="text-2xl font-extrabold text-red-800"></p>
                    </div>
                    <div class="border-l-4 border-red-500 pl-4">
                        <p class="text-lg font-medium text-gray-600">Thermisch (Heizung)</p>
                        <p id="mehrkostenTherm" class="text-2xl font-extrabold text-red-800"></p>
                    </div>
                    <div class="border-l-4 border-red-800 pl-4 bg-red-100 p-2 rounded-md">
                        <p class="text-lg font-medium text-red-800">GESAMT</p>
                        <p id="mehrkostenGesamt" class="text-3xl font-extrabold text-red-900"></p>
                    </div>
                </div>
            </div>

            <div class="text-xs text-gray-500 mt-6 pt-4 border-t">
                <p>
                    *Fachliche Anmerkung: Die Berechnung der Mehrkosten basiert auf den theoretischen Ventilator-√Ñhnlichkeitsgesetzen (Œîp ‚àù n¬≤, P ‚àù n¬≥) und vereinfachten Annahmen zur Luftdichte und Heizperiode. Die berechneten Werte dienen als fundierte Sch√§tzung f√ºr die Kostenprognose.
                </p>
            </div>
        </div>

    </div>
</body>
</html>
